<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Blog"/><link rel="canonical" href="https://your-website-url.com/posts/gitlab-tutorial"/><meta name="twitter:url" content="https://your-website-url.com/posts/gitlab-tutorial"/><meta name="og:url" content="https://your-website-url.com/posts/gitlab-tutorial"/><title>ä½¿ç”¨ gitlab æ­å»ºä»£ç æ‰˜ç®¡å¹³å° | Blog</title><meta name="twitter:title" content="ä½¿ç”¨ gitlab æ­å»ºä»£ç æ‰˜ç®¡å¹³å° | Blog"/><meta name="og:title" content="ä½¿ç”¨ gitlab æ­å»ºä»£ç æ‰˜ç®¡å¹³å° | Blog"/><meta name="description" content="å¼€å‘å›¢é˜Ÿä¸­å¦‚ä½•æ›´å¥½çš„è¿›è¡Œä»£ç ç®¡ç†å’Œåä½œï¼Œå¦‚ä½•å…è´¹æ­å»ºä¸€å°ä»£ç æ‰˜ç®¡å¹³å°ï¼Œè¿™ç¯‡æ–‡ç« ä¼šç»™ä½ ç­”æ¡ˆ"/><meta name="twitter:description" content="å¼€å‘å›¢é˜Ÿä¸­å¦‚ä½•æ›´å¥½çš„è¿›è¡Œä»£ç ç®¡ç†å’Œåä½œï¼Œå¦‚ä½•å…è´¹æ­å»ºä¸€å°ä»£ç æ‰˜ç®¡å¹³å°ï¼Œè¿™ç¯‡æ–‡ç« ä¼šç»™ä½ ç­”æ¡ˆ"/><meta name="og:description" content="å¼€å‘å›¢é˜Ÿä¸­å¦‚ä½•æ›´å¥½çš„è¿›è¡Œä»£ç ç®¡ç†å’Œåä½œï¼Œå¦‚ä½•å…è´¹æ­å»ºä¸€å°ä»£ç æ‰˜ç®¡å¹³å°ï¼Œè¿™ç¯‡æ–‡ç« ä¼šç»™ä½ ç­”æ¡ˆ"/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Blog"/></head><body class="item-page"><header><div class="wrapper"><a class="site-name" href="/">Blog</a></div></header><div class="wrapper"><article><div class="content"><h1>ä½¿ç”¨ gitlab æ­å»ºä»£ç æ‰˜ç®¡å¹³å°</h1><p><a href="https://github.com">github</a>æ˜¯ç›®å‰æœ€ä¸ºæµè¡Œçš„ä»£ç æ‰˜ç®¡å¹³å°ï¼Œå¾ˆå¤šè‘—åçš„å¼€æºé¡¹ç›®éƒ½åœ¨githubä¸Šè¿›è¡Œæ‰˜ç®¡ã€‚ä½†githubåªèƒ½å…è´¹æ‰˜ç®¡å…¬æœ‰é¡¹ç›®ï¼Œå¦‚æœè¦æ‰˜ç®¡ç§æœ‰é¡¹ç›®å°±è¦ç¼´çº³ä¸è²çš„è´¹ç”¨ã€‚è€Œä¸”githubæœåŠ¡å™¨åœ¨å›½å¤–ï¼Œå¾ˆéš¾ä¿è¯ç½‘ç»œçš„ç¨³å®šã€‚ä¸ºäº†ä¿è¯ä»£ç çš„å®‰å…¨å’Œå¯æ§ï¼Œå…¬å¸æ›´å€¾å‘äºè‡ªå»ºä»£ç æœåŠ¡å™¨ã€‚</p><h2>gitlabæ˜¯ä»€ä¹ˆ</h2><blockquote><p>Version Control on your Server like GitHub but Open Source</p></blockquote><p>ä¸€å¥è¯ï¼Œgitlabå°±æ˜¯githubçš„å¼€æºå®ç°ã€‚å®ƒçš„ç‰¹ç‚¹å¦‚ä¸‹ï¼š</p><ul><li>gitä»“åº“ç®¡ç†ï¼Œä»£ç å®¡æŸ¥ï¼Œé—®é¢˜è¿½è¸ªï¼Œæ´»åŠ¨ä¿¡æ¯ï¼Œç»´åŸºå’ŒæŒç»­é›†æˆã€‚</li><li>å®¹çº³25000+çš„ç”¨æˆ·ç¾¤åŒæ—¶åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šã€‚LDAP/ADç»„åŒæ­¥å’Œæ—¥å¿—å®¡è®¡ã€‚</li><li>ç¤¾åŒºé©±åŠ¨ï¼Œ700+è´¡çŒ®è€…ï¼Œæ£€æŸ¥å®Œå–„ä»£ç ï¼Œæ–¹ä¾¿é›†æˆã€‚</li><li>å¦‚æœä¸æƒ³æ‰‹åŠ¨æ­å»ºgitlabï¼Œå¯ä»¥çœ‹<a href="https://about.gitlab.com/pricing/#gitlab-com">è¿™é‡Œ</a></li></ul><h2>å¦‚ä½•æ­å»º</h2><h3>éƒ¨ç½²ç¯å¢ƒubuntu14.04 serverç‰ˆæ“ä½œç³»ç»Ÿ</h3><p>æˆ‘ä»¬å…¬å¸ä¸»æœºCPUæ˜¯32ä½çš„ï¼Œæ‰€ä»¥ä¸‹è½½32ä½çš„ubuntué•œåƒã€‚ä¸‹è½½åœ°å€åœ¨<a href="http://www.ubuntu.org.cn/download/server">è¿™é‡Œ</a>ï¼Œå®‰è£…è¿‡ç¨‹å°±ä¸è¯´äº†ï¼Œæˆ‘æ˜¯ç”¨å…‰é©±å¼•å¯¼å®‰è£…çš„ï¼Œå½“ç„¶ä¹Ÿæœ‰å…¶ä»–æ–¹æ³•ã€‚</p><h3>å®‰è£…openssh-server</h3><p>ä¸ºä»€ä¹ˆè¦å®‰è£…å®ƒå‘¢ï¼Ÿ<code>openssh-server</code>ä¸»è¦ç”¨äºå…¶ä»–ç»ˆç«¯è¿œç¨‹è¿æ¥æœåŠ¡å™¨ã€‚é»˜è®¤ubuntu14.04ç³»ç»Ÿåªæœ‰<code>openssh-client</code>ï¼Œè€Œ<code>openssh-server</code>éœ€è¦è‡ªå·±å®‰è£…ã€‚æ€ä¹ˆçœ‹ç³»ç»Ÿæœ‰æ²¡æœ‰å®‰è£…sshå‘¢ï¼Œé€šè¿‡å¦‚ä¸‹å‘½ä»¤ï¼š<code>dpkg --list|grep ssh</code>ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œæ§åˆ¶å°ä¼šåˆ—å‡º<code>openssh-client</code>å’Œ<code>openssh-server</code>ï¼Œè¯´æ˜å·²ç»å®‰è£…äº†ï¼Œå¦‚æœæ²¡æœ‰<code>openssh-server</code>ï¼Œéœ€è¦é€šè¿‡å¦‚ä¸‹å‘½ä»¤å®‰è£…<code>sudo apt-get install openssh-server</code>ï¼Œç»“æœåœ¨å®‰è£…è¿™ä¸ªçš„æ—¶å€™æŠ¥é”™</p><pre><code><span class="type">Reading</span> package lists... <span class="type">Done
Building</span> dependency tree
<span class="type">Reading</span> state information... <span class="type">Done
Package</span> openssh-server <span class="keyword">is</span> not available,but <span class="keyword">is</span> referred to by another package. <span class="type">This</span> may mean that the package <span class="keyword">is</span> missing, has been obsoleted, is only available from another source
<span class="type">E</span>: <span class="type">Package</span> 'openssh-server' has no installation candidate
</code></pre><p>googleäº†ä¸€ä¸‹ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯æ›´æ–°åŒ…</p><pre><code>sudo apt-<span class="keyword">get</span> update
sudo apt-<span class="keyword">get</span> upgrade
</code></pre><p>ç»“æœåˆæŠ¥äº†å¦‚ä¸‹é”™è¯¯ï¼š</p><pre><code><span class="type">Reading</span> package lists... <span class="type">Done
Building</span> dependency tree
<span class="type">Reading</span> state information... <span class="type">Done
Some</span> packages could not be install.  <span class="type">This</span> may mean that you have requested an impossible situation or <span class="keyword">if</span> you are using the unstable distribution that <span class="keyword">some required</span> packages have not yet been created or been moved out of <span class="type">Incoming</span>.
<span class="type">The</span> following information may help to resolve the situation:

<span class="type">The</span> following packages have unmet dependencies:
openssh-server : <span class="type">Depends</span>: <span class="call">libwrap0</span>(&gt;= <span class="number">7.6</span>-<span class="number">4</span>~) but it <span class="keyword">is</span> not installable

<span class="type">Unable</span> to correct problems, you have held broken packages.
</code></pre><p>æ§åˆ¶å°æç¤ºçš„æ„æ€æ˜¯ï¼Œå®‰è£…<code>openssh-server</code>è¦ä¾èµ–<code>libwrap0</code>è¿™ä¸ªåº“ï¼Œäºæ˜¯æˆ‘å°±åˆæ‰§è¡Œäº†<code>sudo apt-get install libwrap0</code>ã€‚ç»“æœåˆæ‰“å°äº†ä¸€å †ç±»ä¼¼é”™è¯¯ï¼Œæç¤ºåˆè¦ä¾èµ–å…¶ä»–çš„åº“ï¼Œäºæ˜¯è§‰çš„ä¸å¯¹åŠ²äº†ï¼Œåˆgoogleäº†ä¸€ä¸‹ï¼Œæ‰¾åˆ°äº†åŸå› ï¼Œæ˜¯å› ä¸ºåœ¨<code>sudo apt-get update</code>çš„æ—¶å€™æ²¡æœ‰updateå®Œå…¨ã€‚é‡åˆ°äº† <strong>"Hash sum mismatch"</strong> errorã€‚æ€ä¹ˆè§£å†³å‘¢ï¼Ÿ</p><pre><code>sudo rm -rf /<span class="keyword">var</span>/lib/apt/lists<span class="comment">/*   //é¦–å…ˆæ¸…ç©º/var/lib/apt/lists/ç›®å½•ï¼Œç„¶åæ›´æ–°
sudo apt-get update</span>
</code></pre><p>ç„¶å<code>openssh-server</code>å°±é¡ºåˆ©å®‰è£…ä¸Šäº†ï¼Œç½‘ä¸Šè§£å†³æ–¹æ¡ˆåœ°å€åœ¨<a href="http://askubuntu.com/questions/575639/cant-get-anything-to-install-dependency-errors">è¿™é‡Œ</a>ã€‚ å¦‚ä½•åˆ¤æ–­sshserveræ˜¯å¦å¯åŠ¨äº†å‘¢ï¼Ÿ</p><pre><code>ps -e | grep ssh
</code></pre><p>å¦‚æœåªæœ‰<code>ssh-agent</code>ï¼Œé‚£è¯´æ˜<code>ssh-server</code>è¿˜æ²¡æœ‰å¯åŠ¨ï¼Œéœ€è¦</p><pre><code>/etc/<span class="keyword">init</span>.<span class="property">d</span>/ssh start
</code></pre><p><code>ssh-server</code>é…ç½®æ–‡ä»¶ä½äº<code>/ etc/ssh/sshd_config</code>ï¼Œåœ¨è¿™é‡Œå¯ä»¥å®šä¹‰SSHçš„æœåŠ¡ç«¯å£ï¼Œé»˜è®¤ç«¯å£æ˜¯22ï¼Œä½ å¯ä»¥è‡ªå·±å®šä¹‰æˆå…¶ä»–ç«¯å£å·ï¼Œå¦‚222ã€‚ç„¶åé‡å¯SSHæœåŠ¡ï¼š</p><pre><code>sudo /etc/<span class="keyword">init</span>.<span class="property">d</span>/ssh resart
</code></pre><p>ä¸€èˆ¬æƒ…å†µä¸‹ç”¨é»˜è®¤ç«¯å£å°±è¡Œï¼Œæ“ä½œå®Œæ¯•ï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥åœ¨è‡ªå·±çš„ç”µè„‘ä¸Šé€šè¿‡sshè¿œç¨‹é“¾æ¥ä¸»æœºæœåŠ¡å™¨äº†ã€‚</p><h3>å®‰è£…gitlabåŒ…</h3><p>åœ¨å®‰è£…gitlabåŒ…çš„æ—¶å€™åˆé‡åˆ°ä¸ªéº»çƒ¦ï¼Œgitlabå®˜ç½‘çš„<a href="https://about.gitlab.com/downloads/">ä¸‹è½½é¡µé¢</a>æ ¹æœ¬æ²¡æœ‰æä¾›ä»»ä½•32ä½çš„åŒ…ï¼Œå…¨éƒ¨æ˜¯amd64ã€‚æˆ‘ç«‹é©¬éƒé—·äº†ï¼Œå¥½ä¸å®¹æ˜“åˆ°è¿™å„¿äº†ï¼Œéš¾é“è¿˜è¦æ¢å°64ä½çš„ä¸»æœºã€‚ä¸ºäº†ç»™å…¬å¸å°‘æ‰¾éº»çƒ¦ï¼Œæˆ‘è¿˜æ˜¯è‡ªå·±å…ˆæ‰¾æ‰¾æœ‰æ²¡æœ‰ä»€ä¹ˆworkaroundå§ï¼ŒåŠŸå¤«ä¸è´Ÿæœ‰å¿ƒäººï¼Œç»ˆäºæ‰¾åˆ°äº†ä¸€ä¸ªæ–¹æ¡ˆ<a href="https://bitnami.com/stack/gitlab">bitnami gitlab</a>ï¼Œæä¾›ä¸€é”®å¼å®‰è£…gitlabï¼Œæœ€ä¸»è¦æ”¯æŒ32ä½ï¼Œå¤ªæ£’äº†ï¼æ“ä½œå¾ˆç®€å•</p><p>ç¬¬ä¸€æ­¥ä¸‹è½½<a href="https://bitnami.com/stack/gitlab/installer">installer</a></p><pre><code>wget https://downloads.<span class="property">bitnami</span>.<span class="property">com</span>/files/stacks/gitlab/<span class="number">7.6.2</span>-<span class="number">0</span>/bitnami-gitlab-<span class="number">7.6.2</span>-<span class="number">0</span>-linux-installer.<span class="property">run</span>
</code></pre><p>ç¬¬äºŒæ­¥å®‰è£…installer</p><pre><code>chmod <span class="number">744</span> bitnami-gitlab-<span class="number">7.6.2</span>-<span class="number">0</span>-linux-installer.<span class="property">run</span> <span class="comment">//è¿™æ­¥å¾ˆå…³é”®ï¼Œå¦åˆ™æç¤º command not found</span>
./bitnami-gitlab-<span class="number">7.6.2</span>-<span class="number">0</span>-linux-installer.<span class="property">run</span>
</code></pre><p>æ¥ä¸‹æ¥å°±æ˜¯ä¸€æ­¥ä¸€æ­¥å®‰è£…äº†ï¼Œéœ€è¦é…ç½®å¾ˆå¤šä¿¡æ¯ï¼Œå…·ä½“é…ç½®è¯´æ˜å¯ä»¥çœ‹<a href="https://bitnami.com/stack/gitlab/README.txt">è¿™é‡Œ</a></p><p>ç­‰é…ç½®å®Œäº†ï¼Œæˆ‘åœ¨è‡ªå·±ç”µè„‘æµè§ˆå™¨è¾“å…¥ 192.168.30.196 ï¼Œç¥å¥‡çš„äº‹æƒ…å‘ç”Ÿå•¦ï¼ŒgitlabæœåŠ¡å™¨è·‘èµ·æ¥äº†ã€‚è¾“å…¥ç”¨æˆ·åï¼Œå¯†ç å³å¯ç™»å½•ã€‚</p><h3>gitlabé‚®ä»¶ç³»ç»Ÿ</h3><p>gitlabå†…ç½®é‚®ä»¶ç³»ç»Ÿï¼Œè¿™æ ·ç”¨æˆ·åœ¨æ‰§è¡Œç›¸å…³æ“ä½œçš„æ—¶å€™ä¼šè‡ªåŠ¨å‘é‚®ä»¶æ¥é€šçŸ¥ç›¸å…³æˆå‘˜ã€‚ è¿™ä¸ªåŠŸèƒ½å¾ˆèµï¼Œä¸‹é¢è¯´ä¸€ä¸‹é…ç½®æµç¨‹ï¼š</p><p>1 é¦–å…ˆç”³è¯·ä¸€ä¸ªæ–°çš„é‚®ç®± <code>xxx@163.com</code>ã€‚</p><p>2 <code>sudo vi /opt/gitlab-7.6.2-0/apps/gitlab/htdocs/config/environments/production.rb</code></p><p>ä¿®æ”¹å¦‚ä¸‹ä¿¡æ¯ï¼š</p><pre><code>config.<span class="property">action_mailer</span>.<span class="property">smtp_settings</span> = {
:address =&gt; <span class="string">"smtp.qiye.163.com"</span>,
:port =&gt; <span class="string">"25"</span>,
:domain =&gt; <span class="string">"163.com"</span>,
:authentication =&gt; :plain,
:user_name =&gt; <span class="string">"xxx@163.com"</span>,
:password =&gt; <span class="string">"your password"</span>,
:enable_starttls_auto =&gt; <span class="keyword">false</span>
}
</code></pre><p>3 <code>sudo vi /opt/gitlab-7.6.2-0/apps/gitlab/htdocs/config/gitlab.yml</code></p><p>æ‰¾åˆ°<code>email_from:</code>è¿™ä¸€è¡Œï¼Œæ”¹æˆ <code>email_from: xxx@163.com</code></p><p>4 é‡å¯gitlabæœåŠ¡: <code>sudo /opt/gitlab-7.6.2-0/ctlscript.sh restart gitlab_sidekiq</code></p><h3>ä¿®æ”¹æœåŠ¡å™¨IPåœ°å€</h3><p>å¦‚æœå…¨éƒ¨æŒ‰ç…§é»˜è®¤é€‰é¡¹å®‰è£…ï¼Œåˆ›å»ºä¸€ä¸ªprojectï¼Œç”Ÿæˆçš„ä»“åº“åœ°å€æ˜¯è¿™æ ·çš„ï¼š<code>git@127.0.0.1:username/test.git</code>ï¼Œè¿™æ˜¾ç„¶ä¸å¯¹ï¼Œå› ä¸ºè¿™æ˜¯æœ¬æœºåœ°å€ï¼Œè€Œå¼€å‘äººå‘˜åš<code>git clone</code>æ“ä½œæ—¶ï¼Œæ˜¯åœ¨è‡ªå·±çš„ç”µè„‘ä¸Šå®Œæˆçš„ï¼Œå¦‚ä½•é…ç½®æœåŠ¡å™¨IPåœ°å€ï¼Ÿ åœ¨gitlab.ymlè¿™ä¸ªé…ç½®æ–‡ä»¶ä¸­å®šä½åˆ°<code>host:</code>ï¼Œè®¾ç½®IPå³å¯ ã€‚</p><p>sudo vi /opt/gitlab-7.6.2-0/apps/gitlab/htdocs/config/gitlab.yml</p><pre><code>## <span class="type">GitLab</span> settings
gitlab:
## <span class="type">Web</span> server settings (note: host <span class="keyword">is</span> the <span class="type">FQDN</span>, do not include http://)
host: <span class="number">192.168.30.196</span> <span class="comment">//æŠŠè¿™é‡Œæ”¹æˆæœåŠ¡å™¨ipå°±å¯ä»¥äº†</span>
port: <span class="number">80</span> # <span class="type">Set</span> to <span class="number">443</span> <span class="keyword">if</span> using <span class="type">HTTPS</span>, see installation.<span class="property">md#using</span>-https <span class="keyword">for</span> additional <span class="type">HTTPS</span> configuration details
</code></pre><p>é‡å¯gitlabæœåŠ¡: <code>sudo /opt/gitlab-7.6.2-0/ctlscript.sh restart gitlab_sidekiq</code></p><h3>è®¾ç½®gitlabå¼€æœºè‡ªå¯åŠ¨</h3><p>é™¤äº†è¿™äº›è¿˜æœ‰ä»€ä¹ˆéœ€è¦åšå—ï¼Ÿé‚£å°±æ˜¯å¼€æœºè‡ªå¯åŠ¨ï¼Œè¿™æ ·å¯ä»¥ä¿è¯æœåŠ¡å™¨å› ä¸ºå„ç§åŸå› é‡å¯åï¼ŒgitlabæœåŠ¡æŒç»­å¯ç”¨ã€‚</p><pre><code>sudo cp /opt/gitlab-<span class="number">7.6.2</span>-<span class="number">0</span>/ctlscript.<span class="property">sh</span> /etc/<span class="keyword">init</span>.<span class="property">d</span>/bitnami-gitlab
sudo update-rc.<span class="property">d</span> -f bitnami-gitlab start <span class="number">80 2 3 4 5</span> . <span class="property">stop</span> <span class="number">30 0 1 6</span> .
</code></pre></div><span>Tagged with: </span><ul class="tag-list"><li><a href="/tags/tutorial">tutorial</a></li></ul></article><div class="item-navigator"><table><tr><td class="previous-item"><a href="/posts/website-use-hugo">ğŸ‘ˆ ä½¿ç”¨ Hugo + Travis CI + Github Pages æ­å»ºé™æ€åšå®¢</a></td><td></td></tr></table></div><footer><p>Generated using <a href="https://github.com/johnsundell/publish">Publish</a></p><p><a href="/feed.rss">RSS feed</a></p></footer></div></body></html>